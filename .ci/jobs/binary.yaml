jobs:
  - job: "Binary"
    pool:
      vmImage: "$(os)"

    strategy:
      matrix:
        Windows:
          os: "windows-latest"
          name: windows
        Linux:
          os: "ubuntu-latest"
          name: linux
    #        MacOS:
    #          os: "macos-latest"

    steps:
      - template: /.ci/templates/install-project.yaml
        parameters:
          python_version: "3.7"

      - script: pyinstaller bgmi.spec

      - task: ArchiveFiles@2
        inputs:
          rootFolderOrFile: "./dist"
          includeRootFolder: false
          archiveFile: "$(Build.ArtifactStagingDirectory)/bgmi-$(Agent.OS).zip"
          replaceExistingArchive: true
          verbose: true # Optional

      - task: PublishBuildArtifacts@1
        inputs:
          pathToPublish: "$(Build.ArtifactStagingDirectory)"
          artifactName: binary
